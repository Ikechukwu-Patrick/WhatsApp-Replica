name: Check for Hardcoded Environment Variables

on:
  pull_request:
    branches: [ master ]  # ðŸ‘ˆ Trigger on pull requests to the 'master' branch
  push:
    branches: [ master ]  # ðŸ‘ˆ Trigger on pushes to the 'master' branch

jobs:
  check-env-vars:
    runs-on: ubuntu-latest  # ðŸ‘ˆ Run on the latest Ubuntu runner

    steps:
      - name: Checkout Repository
        uses: actions/checkout@v3  # ðŸ‘ˆ Check out the repository
        with:
          fetch-depth: 2  # ðŸ‘ˆ Fetch the last 2 commits for `git diff` comparison

      - name: Check for Hardcoded Values in application.properties
        run: |
          # Check application.properties for hardcoded values
          if git diff HEAD^ HEAD -- application.properties | grep '^+' | grep -E '^\+[^#]*=' | grep -v '=\s*\${'; then
            echo "::error::Hardcoded values detected in application.properties. Use placeholders (e.g., \${VAR})."
            exit 1
          fi